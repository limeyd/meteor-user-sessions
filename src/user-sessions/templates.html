<template name="createSessionActivator">
  {{#if currentUser}}
    <a id="signOutButton" type="submit" class="btn" data-modal-name="createSessionForm">
      <i class="icon-lock"></i>
      Sign out
    </a>
  {{else}}
    <a id="createSessionActivator" type="submit" class="modalActivator btn" data-modal-name="createSessionForm">
      <i class="icon-lock"></i>
      Sign in
    </a>
  {{/if}}
  {{> createSessionForm}}
</template>

<template name="createUserActivator">
  {{#unless currentUser}}
    <a id="createUserActivator" type="submit" class="modalActivator btn" data-modal-name="createUserForm">
      <i class="icon-user"></i>
      Sign up
    </a>
  {{/unless}}
  {{> createUserForm}}
</template>

<template name="createSessionForm">
  <div id="createSessionForm" class="modal hide fade">
    <form style="display:inline" data-method-name="createSession">
      <div class="modal-body">
        <input name="csrfToken" type="hidden" value="TODO">
        <div class="modal-header">
          <button class="close" data-dismiss="modal">×</button>
          <h3>Sign in</h3>
        </div>
        {{> successMessage}}
      
        <div class="formElementGroup">
          {{#if plainTextWarning}}
            <div  class="alert alert-warning">
              {{plainTextWarning}}
            </div>
          {{/if}}
          <div id="emailField" class="control-group">
            <label>Email</label>
            <input id="sessionEmail" name="email" type="text" class="span3 entry focus" placeholder="Your email address…">
          </div>
          <div id="sessionPasswordField" class="control-group">
            <label>Password</label>
            <input id="sessionPassword" name="password" type="password" class="span3 entry" placeholder="Your password…">
            <label class="checkbox">
              <input id="sessionRemember" name="remember" type="checkbox" value="1"> Remember me?
            </label>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <a class="btn" data-dismiss="modal">Cancel</a>
        <input id="signInButton" type="submit" value="Sign in" class="btn" />
      </div>
    </form>
  </div>
</template>

<template name="createUserForm">
  <div id="createUserForm" class="modal hide fade">
    <form style="display:inline" data-method-name="createUser">
      <div class="modal-body">
        <input name="csrfToken" type="hidden" value="TODO">
        <div class="modal-header">
          <button class="close" data-dismiss="modal">×</button>
          <h3>Sign up</h3>
        </div>
        {{> successMessage}}
      
        <div class="formElementGroup">
          {{#if plainTextWarning}}
            <div  class="alert alert-warning">
              {{plainTextWarning}}
            </div>
          {{/if}}
          <div id="emailField" class="control-group">
            <label>Email</label>
            <input id="userEmail" name="email" type="text" class="span3 entry focus" placeholder="Your email address…">
          </div>
          <div id="passwordField" class="control-group">
            <label>Password</label>
            <input id="userPassword" name="password" type="password" class="span3 entry" placeholder="Your password…">
          </div>
          <div id="passwordConfirmationField" class="control-group">
            <label>Confirm password</label>
            <input id="userPasswordConfirmation" name="passwordConfirmation" type="password" class="span3 entry" placeholder="Confirm your password…">
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <a class="btn" data-dismiss="modal">Cancel</a>
        <input id="signUpButton" type="submit" value="Sign up" class="modalSubmit btn" />
      </div>
    </form>
  </div>
</template>

<template name="successMessage">
  {{#if successMessage}}
    {{#with successMessage}}
      <div id="successMessage" class="alert alert-error">
          <strong>{{reason}}</strong>
          {{#if details}}
            <div id="errorDetails">
              {{#each details}}
                <p>{{message}}</p>
              {{/each}}
            </div>
          {{/if}}
      </div>
    {{/with}}
  {{/if}}
</template>

<template name="successMessage">
  {{#if successMessage}}
    <div id="successMessage" class="alert alert-success">
      {{successMessage}}
    </div>
  {{/if}}
</template>
