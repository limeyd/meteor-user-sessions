<head>
  <title>User Sessions Demo</title>
</head>

<body>
  {{> demo}}
  {{> forkMe}}
</body>

<template name="demo">

  <h1>User Sessions Demo</h1>

  <p><em>Attach users to <a href="http://client-sessions.meteor.com">client-sessions</a></em></p>

  <div>
    {{#if userSessionSuccess}}
      <div id="userSessionSuccess" class="alert alert-success">{{userSessionSuccess}}</div>
    {{/if}}
    
    <div class="well">
      {{> signInActivator}}

      <div id="currentUserInfo">
        {{#if currentUser}}
          <p><em>Signed in as</em> <strong>{{currentUser}}</strong></p>
          {{#if sessionId}}
            <p><em>Your session ID is</em> <strong>{{sessionId}}</strong></p>
          {{/if}}
          <p>Your session expires <strong>{{#if rememberUntil}}{{rememberUntil}}{{else}}when you close this browser window{{/if}}</strong>.</p>
        {{else}}
          <p><em>You're not signed in right now!</em></p>
        {{/if}}
      </div>
    </div>
  </div>
</template>

<template name="signInActivator">
  {{#if currentUser}}
    <h3>Sign out of the demo!</h3>
    <div>
      <input id="signOutButton" type="submit" value="Sign out now!" class="btn btn-primary" />
    </div>
  {{else}}
    <h3>Sign in or sign up!</h3>
    <div>
      <div class="pull-left">
        <input id="createSessionActivator" type="submit" value="Sign in now!" class="modalActivator btn btn-primary" data-modal-name="createSession" />
      </div>
      <div>
        <input id="createUserActivator" type="submit" value="Sign up" class="modalActivator btn btn-primary" data-modal-name="createUser" />
      </div>
    </div>
  {{/if}}
  {{> signInForm}}
  {{> createUserForm}}
</template>

<template name="signInForm">
  <div id="createSessionForm" class="modal hide fade">
    <form style="display:inline" class="sessionForm" data-form-name="createSession">
      <div class="modal-body">
        <input name="csrfToken" type="hidden" value="TODO">
        <div class="modal-header">
          <button class="close" data-dismiss="modal">×</button>
          <h3>Sign in</h3>
        </div>
        {{> userSessionError}}
      
        <div id="userFormElements">
          {{#if plainTextWarning}}
            <div  class="alert alert-warning">
              {{plainTextWarning}}
            </div>
          {{/if}}
          <div id="emailField" class="control-group">
            <label>Email</label>
            <input id="sessionEmail" name="email" type="text" class="span3 focus" placeholder="Your email address…" value="moof@moof.com">
          </div>
          <div id="sessionPasswordField" class="control-group">
            <label>Password</label>
            <input id="sessionPassword" name="password" type="password" class="span3" placeholder="Your password…" value="moofmoof123">
            <label class="checkbox">
              <input id="sessionRemember" name="remember" type="checkbox" value="1"> Remember me?
            </label>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <a class="btn" data-dismiss="modal">Cancel</a>
        <input id="signInButton" type="submit" value="Sign in" class="btn btn-primary modalSubmit" />
      </div>
    </form>
  </div>
</template>

<template name="forkMe">
  <a href="https://github.com/possibilities/meteor-user-sessions"><img class="forkMe" style="position: absolute; top: 0; right: 0; border: 0;" data-src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub"></a>
</template>
